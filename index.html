<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Grade Transfer Tool</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Coustard:wght@400;900&family=Fira+Mono:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>

    <h1>Grade Transfer Tool</h1>

    <!-- Section: CSV Upload -->
    <div class="file-section">
        <h2>CSV File (From LMS)</h2>
        <input type="file" id="csvFileInput" accept=".csv">
        <p id="csvFileName">No file selected</p>

        <label for="csvStudentCol">Select Student Number Column:</label>
        <select id="csvStudentCol"></select>

        <label for="csvMarkCol">Select Marks Column:</label>
        <select id="csvMarkCol"></select>
    </div>

    <!-- CSV Preview -->
    <div id="csvPreview" class="preview-block"></div>
    <p id="csvInfo" class="info-text"></p>

    <!-- Section: Excel Template Upload -->
    <div class="file-section">
        <h2>Excel Template File</h2>
        <input type="file" id="excelFileInput" accept=".xlsx">
        <p id="excelFileName">No file selected</p>

        <label for="excelStudentCol">Select Student Number Column:</label>
        <select id="excelStudentCol"></select>

        <label for="excelMarkDestCol">Select Destination Column for Marks:</label>
        <select id="excelMarkDestCol"></select>
    </div>

    <!-- Excel Preview -->
    <div id="excelPreview" class="preview-block"></div>
    <p id="excelInfo" class="info-text"></p>

    <!-- Section: Transfer Options -->
    <div class="file-section">
        <h2>Transfer Options</h2>

        <!-- ICE Task Mode -->
        <label>
            <input type="checkbox" id="iceCheckbox">
            Treat this as an ICE Task (100 if attempted, 0 if not)
        </label>

        <!-- Custom Filename -->
        <label for="customFilename">Optional: Enter custom filename (without extension):</label>
        <input type="text" id="customFilename" placeholder="Leave blank to use original filename">
    </div>

    <!-- Action Buttons -->
    <button id="transferButton">TRANSFER MARKS</button>
    <button id="downloadButton" disabled>Download Updated CSV</button>
    <button id="resetButton">Reset</button>

    <!-- Result Preview -->
    <div id="resultPreview" class="preview-block"></div>
    <p id="resultInfo" class="info-text"></p>

    <!-- Log output -->
    <div id="logOutput"></div>

    <script src="script.js"></script>
</body>
</html>
